{"nbformat":4,"nbformat_minor":0,"metadata":{"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.6.6"},"colab":{"name":"TF CNN B cats vs dogs transfer learning (강의)","provenance":[{"file_id":"1mOb43_XjSwsekQaN_CpjztbNr5Ca_7Fg","timestamp":1607994696414},{"file_id":"1jT81Yclu6AJiH1gMeGly4-BaHacSpXpt","timestamp":1599004079949},{"file_id":"17Eh3w2gVDXbxsOrkcU8gfXIRanXtyOya","timestamp":1596216960669}],"collapsed_sections":[]},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"b5bfa3919b1b4415bc0e462790b6771d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_426a7a9831c94e358e9ff9e7da8a4aa8","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_2925f05cc62b4e07bc2814f8466e45c0","IPY_MODEL_71e3de30203f40ceb0477ca20b21594c"]}},"426a7a9831c94e358e9ff9e7da8a4aa8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2925f05cc62b4e07bc2814f8466e45c0":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_7bd3c180817e43a59f2696bb26e877a8","_dom_classes":[],"description":"Dl Completed...: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_459bed700b0b4ae5ae30f1d68d1f64e0"}},"71e3de30203f40ceb0477ca20b21594c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ea974868f538464d9cde1e0b6a1e610b","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1/1 [00:08&lt;00:00,  8.88s/ url]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_614aae650bdb46b1aa00b34f31583ea7"}},"7bd3c180817e43a59f2696bb26e877a8":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"459bed700b0b4ae5ae30f1d68d1f64e0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ea974868f538464d9cde1e0b6a1e610b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"614aae650bdb46b1aa00b34f31583ea7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d79851dbb22b46e89507b0bb93cb4bc2":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_06ee77d190cc4841825848b8c807c006","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_e90f5fcbe8754840a5e66ce00c729117","IPY_MODEL_dcfccef1708943d9bd053b58645e4e4e"]}},"06ee77d190cc4841825848b8c807c006":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e90f5fcbe8754840a5e66ce00c729117":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_e92629cbe3ea4fdd8cb4e7de982ee7cb","_dom_classes":[],"description":"Dl Size...: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_81840cfb72cd4cd4b4654ea15dacbbb5"}},"dcfccef1708943d9bd053b58645e4e4e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_b3f4d48d1d8540b18e9e1bfea175115f","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 786/786 [00:08&lt;00:00, 88.73 MiB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_65db4fbe110143659187e871797216b9"}},"e92629cbe3ea4fdd8cb4e7de982ee7cb":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"81840cfb72cd4cd4b4654ea15dacbbb5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b3f4d48d1d8540b18e9e1bfea175115f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"65db4fbe110143659187e871797216b9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"39fe4ae27fde4de6b3d7568cfc7d2d3a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_0788a4339fe54818ba2365e5e9f3f4ed","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_c5d7cec6a91b429abfc69ee46509f599","IPY_MODEL_bb986e685fc14fe19d2d45a3a1340676"]}},"0788a4339fe54818ba2365e5e9f3f4ed":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c5d7cec6a91b429abfc69ee46509f599":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_c458d1c844ff4b66959795950af4c1e0","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_440c7db31a344caeae1ff95ec5a77671"}},"bb986e685fc14fe19d2d45a3a1340676":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_046eacb13f0547f9b7d031602e3b6179","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 23262/0 [00:11&lt;00:00, 2070.98 examples/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_f4780a730693427fb343ce7d3855353f"}},"c458d1c844ff4b66959795950af4c1e0":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"440c7db31a344caeae1ff95ec5a77671":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"046eacb13f0547f9b7d031602e3b6179":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"f4780a730693427fb343ce7d3855353f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f37280cae32b401eb20c74826348d5bd":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_4ff48ac58e8e425180583c7916aafa94","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_2a2b518d1f9a4b7fb781a2bebf43d865","IPY_MODEL_587e7cbee86741f992adc69e577bb699"]}},"4ff48ac58e8e425180583c7916aafa94":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2a2b518d1f9a4b7fb781a2bebf43d865":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_9260372756ad498c85a27a4653c15687","_dom_classes":[],"description":" 98%","_model_name":"FloatProgressModel","bar_style":"danger","max":23262,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":22865,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_0d279418811a4202a64754867a49fe11"}},"587e7cbee86741f992adc69e577bb699":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_332073313d164154ad5a12242c04410a","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 22865/23262 [00:07&lt;00:00, 7789.47 examples/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_14654bdcfe0549d08fdc6b32b452a664"}},"9260372756ad498c85a27a4653c15687":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"0d279418811a4202a64754867a49fe11":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"332073313d164154ad5a12242c04410a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"14654bdcfe0549d08fdc6b32b452a664":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"markdown","metadata":{"id":"vY-Ca0dhGTAk"},"source":["# Category 3 - Cats vs Dogs 분류\n","\n","* Convolution Neural network 활용한 분류 모델 (Classification)\n","* tensorflow-datasets 를 활용한 데이터 전처리"]},{"cell_type":"markdown","metadata":{"id":"ww0hxcaSGb0m"},"source":["## 확인"]},{"cell_type":"markdown","metadata":{"id":"FI6oK1X-GdJJ"},"source":["1. GPU 옵션 켜져 있는지 확인할 것!!! (수정 - 노트설정 - 하드웨어설정 (GPU))"]},{"cell_type":"markdown","metadata":{"id":"1yoe-K38GQ4b"},"source":["## 순서"]},{"cell_type":"markdown","metadata":{"id":"Bc6iTV8DGPop"},"source":["1. **import**: 필요한 모듈 import\n","2. **전처리**: 학습에 필요한 데이터 전처리를 수행합니다.\n","3. **모델링(model)**: 모델을 정의합니다.\n","4. **컴파일(compile)**: 모델을 생성합니다.\n","5. **학습 (fit)**: 모델을 학습시킵니다."]},{"cell_type":"markdown","metadata":{"id":"msi1agesayxW"},"source":["## 문제"]},{"cell_type":"markdown","metadata":{"id":"Bqqzpm1P8dd9"},"source":["Computer Vision with CNNs\n","<br>\n","<br>For this exercise you will build a cats v dogs classifier\n","<br>using the Cats v Dogs dataset from TFDS.\n","<br>Be sure to use the final layer as shown \n","<br>    **(Dense, 2 neurons, softmax activation)**\n","<br>\n","<br>The testing infrastructre will **resize all images to 224x224**\n","<br>with **3 bytes of color depth**. Make sure your input layer trains\n","<br>images to that specification, or the tests will fail.\n","<br>\n","<br>Make sure your output layer is exactly as specified here, or the \n","<br>tests will fail.\n","\n","----------------------------------------\n","<br>이 연습에서는 cats v dogs 분류기를 만들 것입니다.\n","TFDS의 Cats v Dogs 데이터 세트 사용.\n","<br> 그림과 같이 최종 레이어를 사용하십시오\n","<br> **(Dense, 뉴런 2 개, activation='softmax')**\n","<br>\n","<br> 테스트 인프라는 **모든 이미지의 크기를 224x224로 조정합니다(컬러사진)**. 입력 레이어를 확인하십시오"]},{"cell_type":"code","metadata":{"id":"VXJfrSfG8dd5","executionInfo":{"status":"ok","timestamp":1608554085252,"user_tz":-540,"elapsed":709,"user":{"displayName":"최종찬","photoUrl":"","userId":"12659814370838060539"}}},"source":["import tensorflow_datasets as tfds\n","import tensorflow as tf\n","\n","from tensorflow.keras.layers import Dense, Conv2D, MaxPooling2D, Flatten, Dropout\n","from tensorflow.keras.models import Sequential\n","from tensorflow.keras.applications import VGG16\n","from tensorflow.keras.callbacks import ModelCheckpoint"],"execution_count":12,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"zIXfMfFq8dd9"},"source":["## Load Dataset"]},{"cell_type":"markdown","metadata":{"id":"Kg0sXFW2nil7"},"source":["**tensorflow-datasets**를 활용합니다."]},{"cell_type":"markdown","metadata":{"id":"YTjsZFWGn117"},"source":["* [Cats vs Dogs 데이터셋 문서 보기](https://www.tensorflow.org/datasets/catalog/cats_vs_dogs?hl=ko)\n","\n","* [tensorflow-datasets 다루기](https://www.tensorflow.org/datasets/splits?hl=ko)"]},{"cell_type":"markdown","metadata":{"id":"hTCJ8FxgogB_"},"source":["**시험에서 주어지는 데이터셋 로드 형태**\n","\n","* 예전 방식이므로 아래처러 주어지는 코드를 과감히 삭제 후, 아래 제공되는 방식으로 변경합니다."]},{"cell_type":"code","metadata":{"id":"UfnTxPKH9ub9","executionInfo":{"status":"ok","timestamp":1608553925770,"user_tz":-540,"elapsed":2488,"user":{"displayName":"최종찬","photoUrl":"","userId":"12659814370838060539"}}},"source":[""],"execution_count":1,"outputs":[]},{"cell_type":"code","metadata":{"id":"e1VLqKMO8deA","colab":{"base_uri":"https://localhost:8080/","height":257,"referenced_widgets":["b5bfa3919b1b4415bc0e462790b6771d","426a7a9831c94e358e9ff9e7da8a4aa8","2925f05cc62b4e07bc2814f8466e45c0","71e3de30203f40ceb0477ca20b21594c","7bd3c180817e43a59f2696bb26e877a8","459bed700b0b4ae5ae30f1d68d1f64e0","ea974868f538464d9cde1e0b6a1e610b","614aae650bdb46b1aa00b34f31583ea7","d79851dbb22b46e89507b0bb93cb4bc2","06ee77d190cc4841825848b8c807c006","e90f5fcbe8754840a5e66ce00c729117","dcfccef1708943d9bd053b58645e4e4e","e92629cbe3ea4fdd8cb4e7de982ee7cb","81840cfb72cd4cd4b4654ea15dacbbb5","b3f4d48d1d8540b18e9e1bfea175115f","65db4fbe110143659187e871797216b9","39fe4ae27fde4de6b3d7568cfc7d2d3a","0788a4339fe54818ba2365e5e9f3f4ed","c5d7cec6a91b429abfc69ee46509f599","bb986e685fc14fe19d2d45a3a1340676","c458d1c844ff4b66959795950af4c1e0","440c7db31a344caeae1ff95ec5a77671","046eacb13f0547f9b7d031602e3b6179","f4780a730693427fb343ce7d3855353f","f37280cae32b401eb20c74826348d5bd","4ff48ac58e8e425180583c7916aafa94","2a2b518d1f9a4b7fb781a2bebf43d865","587e7cbee86741f992adc69e577bb699","9260372756ad498c85a27a4653c15687","0d279418811a4202a64754867a49fe11","332073313d164154ad5a12242c04410a","14654bdcfe0549d08fdc6b32b452a664"]},"executionInfo":{"status":"ok","timestamp":1608553954779,"user_tz":-540,"elapsed":31494,"user":{"displayName":"최종찬","photoUrl":"","userId":"12659814370838060539"}},"outputId":"ca0ed547-3752-499f-9b54-5bbf2bb13ad4"},"source":["dataset_name = 'cats_vs_dogs'\n","\n","# 처음 80%의 데이터만 사용\n","train_dataset = tfds.load(name=dataset_name, split='train[:80%]')\n","\n","# 최근 20%의 데이터만 사용\n","valid_dataset = tfds.load(name=dataset_name, split='train[80%:]')"],"execution_count":2,"outputs":[{"output_type":"stream","text":["\u001b[1mDownloading and preparing dataset cats_vs_dogs/4.0.0 (download: 786.68 MiB, generated: Unknown size, total: 786.68 MiB) to /root/tensorflow_datasets/cats_vs_dogs/4.0.0...\u001b[0m\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"b5bfa3919b1b4415bc0e462790b6771d","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', description='Dl Completed...', max=1.0, style=Progre…"]},"metadata":{"tags":[]}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"d79851dbb22b46e89507b0bb93cb4bc2","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', description='Dl Size...', max=1.0, style=ProgressSty…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","\n","\n","\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"39fe4ae27fde4de6b3d7568cfc7d2d3a","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["WARNING:absl:1738 images were corrupted and were skipped\n"],"name":"stderr"},{"output_type":"stream","text":["\rShuffling and writing examples to /root/tensorflow_datasets/cats_vs_dogs/4.0.0.incompleteCE14EA/cats_vs_dogs-train.tfrecord\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"f37280cae32b401eb20c74826348d5bd","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=23262.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\u001b[1mDataset cats_vs_dogs downloaded and prepared to /root/tensorflow_datasets/cats_vs_dogs/4.0.0. Subsequent calls will reuse this data.\u001b[0m\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"739L8AKh-OZG"},"source":["시험에서 요구하는 **전처리 요구 조건**은 다음과 같습니다.\n","\n","1. 이미지 정규화 (Normalization)\n","2. 이미지 사이즈 맞추기: (224 X 224) \n","3. image(x), label(y)를 분할"]},{"cell_type":"markdown","metadata":{"id":"H7fLV4E6_8uD"},"source":["**[실습코드]**"]},{"cell_type":"code","metadata":{"id":"fV1LU9W1-Swt","executionInfo":{"status":"ok","timestamp":1608553954780,"user_tz":-540,"elapsed":31493,"user":{"displayName":"최종찬","photoUrl":"","userId":"12659814370838060539"}}},"source":["def preprocess(data):\n","    # x, y 데이터를 정의합니다.\n","    x = data['image']\n","    y = data['label']\n","    # image 정규화(Normalization)\n","    x = x / 255\n","    # 사이즈를 (224, 224)로 변환합니다.\n","    x = tf.image.resize(x, size=(224, 224))\n","    # x, y  데이터를 return 합니다.\n","    return x, y"],"execution_count":3,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"cPQ9hOrnpHKj"},"source":["만든 전처리 함수(preprocessing)를 **dataset에 mapping**하고, **batch_size도 지정**합니다."]},{"cell_type":"code","metadata":{"id":"Wq-NyPMI_oZM","executionInfo":{"status":"ok","timestamp":1608553954781,"user_tz":-540,"elapsed":31491,"user":{"displayName":"최종찬","photoUrl":"","userId":"12659814370838060539"}}},"source":["batch_size=32"],"execution_count":4,"outputs":[]},{"cell_type":"code","metadata":{"id":"JRM0LRxt-Sru","executionInfo":{"status":"ok","timestamp":1608553954781,"user_tz":-540,"elapsed":31489,"user":{"displayName":"최종찬","photoUrl":"","userId":"12659814370838060539"}}},"source":["train_data = train_dataset.map(preprocess).batch(batch_size)\n","valid_data = valid_dataset.map(preprocess).batch(batch_size)"],"execution_count":5,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"uvvarzxw8ded"},"source":["## 모델 정의 (Sequential)"]},{"cell_type":"markdown","metadata":{"id":"azRvYVbQnim5"},"source":["이제 Modeling을 할 차례입니다.\n","\n","`Sequential` 모델 안에서 층을 깊게 쌓아 올려 주면 됩니다.\n","\n","1. `input_shape`는 Iris 꽃 데이터셋의 X의 feature 갯수가 4개 이므로 **(4, )**로 지정합니다.\n","2. 깊은 출력층과 더 많은 Layer를 쌓습니다.\n","3. Dense Layer에 `activation='relu'`를 적용합니다.\n","4. 분류(Classification)의 마지막 층의 출력 숫자는 분류하고자 하는 클래스 갯수와 **같아야** 합니다.\n"]},{"cell_type":"code","metadata":{"id":"dcJtZOg0EqA7","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1608553955816,"user_tz":-540,"elapsed":32522,"user":{"displayName":"최종찬","photoUrl":"","userId":"12659814370838060539"}},"outputId":"e413a9d7-6218-4f21-cbd7-7b903992ef61"},"source":["transfer_model = VGG16(weights='imagenet', include_top=False, input_shape=(224, 224, 3)) #include_top이 False이면 FC층을 가져오지 않음\n","transfer_model.trainable=False #가중치를 가져온 부분은 학습되지 않도록 설정"],"execution_count":6,"outputs":[{"output_type":"stream","text":["Downloading data from https://storage.googleapis.com/tensorflow/keras-applications/vgg16/vgg16_weights_tf_dim_ordering_tf_kernels_notop.h5\n","58892288/58889256 [==============================] - 1s 0us/step\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"rpWdaUGX8dee","executionInfo":{"status":"ok","timestamp":1608553955817,"user_tz":-540,"elapsed":32520,"user":{"displayName":"최종찬","photoUrl":"","userId":"12659814370838060539"}}},"source":["model = Sequential([\n","    transfer_model,\n","    Flatten(),\n","    Dropout(0.5),\n","    Dense(512, activation='relu'),\n","    Dense(128, activation='relu'),\n","    Dense(2, activation='softmax'),\n","])"],"execution_count":7,"outputs":[]},{"cell_type":"code","metadata":{"id":"iQRWnG9A8def","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1608553955818,"user_tz":-540,"elapsed":32519,"user":{"displayName":"최종찬","photoUrl":"","userId":"12659814370838060539"}},"outputId":"7914713d-add7-4fef-e04e-320c419c54d8"},"source":["model.summary()"],"execution_count":8,"outputs":[{"output_type":"stream","text":["Model: \"sequential\"\n","_________________________________________________________________\n","Layer (type)                 Output Shape              Param #   \n","=================================================================\n","vgg16 (Functional)           (None, 7, 7, 512)         14714688  \n","_________________________________________________________________\n","flatten (Flatten)            (None, 25088)             0         \n","_________________________________________________________________\n","dropout (Dropout)            (None, 25088)             0         \n","_________________________________________________________________\n","dense (Dense)                (None, 512)               12845568  \n","_________________________________________________________________\n","dense_1 (Dense)              (None, 128)               65664     \n","_________________________________________________________________\n","dense_2 (Dense)              (None, 2)                 258       \n","=================================================================\n","Total params: 27,626,178\n","Trainable params: 12,911,490\n","Non-trainable params: 14,714,688\n","_________________________________________________________________\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"wnmQV-fDnim8"},"source":["## 컴파일 (compile)"]},{"cell_type":"markdown","metadata":{"id":"pHQ1abHXK8e9"},"source":["1. `optimizer`는 가장 최적화가 잘되는 알고리즘인 'adam'을 사용합니다.\n","2. `loss`설정\n","  * 출력층 activation이 `sigmoid` 인 경우: `binary_crossentropy`\n","  * 출력층 activation이 `softmax` 인 경우: \n","    * 원핫인코딩(O): `categorical_crossentropy`\n","    * 원핫인코딩(X): `sparse_categorical_crossentropy`)\n","3. `metrics`를 'acc' 혹은 'accuracy'로 지정하면, 학습시 정확도를 모니터링 할 수 있습니다."]},{"cell_type":"markdown","metadata":{"id":"WNurLvnisN-t"},"source":["전처리 단계에서 **one-hot encoding** 을 해주었습니다. 따라서, `categorical_crossentropy`를 지정해주면 됩니다."]},{"cell_type":"markdown","metadata":{"id":"eXGMljJQhmp_"},"source":["model.compile()"]},{"cell_type":"code","metadata":{"id":"QCLw6RMZnim-","executionInfo":{"status":"ok","timestamp":1608554091670,"user_tz":-540,"elapsed":691,"user":{"displayName":"최종찬","photoUrl":"","userId":"12659814370838060539"}}},"source":["model.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics=['acc'])"],"execution_count":13,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"NyLUPgGCninB"},"source":["## ModelCheckpoint: 체크포인트 생성"]},{"cell_type":"markdown","metadata":{"id":"46Oi04ZMLtEB"},"source":["`val_loss` 기준으로 epoch 마다 최적의 모델을 저장하기 위하여, ModelCheckpoint를 만듭니다.\n","* `checkpoint_path`는 모델이 저장될 파일 명을 설정합니다.\n","* `ModelCheckpoint`을 선언하고, 적절한 옵션 값을 지정합니다."]},{"cell_type":"code","metadata":{"id":"qJwGq3PoninB","executionInfo":{"status":"ok","timestamp":1608554092395,"user_tz":-540,"elapsed":565,"user":{"displayName":"최종찬","photoUrl":"","userId":"12659814370838060539"}}},"source":["checkpoint_path = \"my_checkpoint.ckpt\"\n","checkpoint = ModelCheckpoint(filepath=checkpoint_path, \n","                             save_weights_only=True, \n","                             save_best_only=True, \n","                             monitor='val_loss', \n","                             verbose=1)"],"execution_count":14,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"v3mjb5EAninE"},"source":["## 학습 (fit)"]},{"cell_type":"markdown","metadata":{"id":"3-X6hK_DMYZH"},"source":["1. `validation_data`를 반드시 지정합니다.\n","2. `epochs`을 적절하게 지정합니다.\n","3. `callbacks`에 바로 위에서 만든 checkpoint를 지정합니다."]},{"cell_type":"code","metadata":{"id":"2uHXDA_vninF","colab":{"base_uri":"https://localhost:8080/"},"outputId":"0c720c45-9786-4f93-8b79-a51d6b687009"},"source":["model.fit(train_data,\n","          validation_data=(valid_data),\n","          epochs=20,\n","          callbacks=[checkpoint],\n","          )"],"execution_count":null,"outputs":[{"output_type":"stream","text":["Epoch 1/20\n","582/582 [==============================] - 97s 153ms/step - loss: 0.6100 - acc: 0.8305 - val_loss: 0.1670 - val_acc: 0.9282\n","\n","Epoch 00001: val_loss improved from inf to 0.16704, saving model to my_checkpoint.ckpt\n","Epoch 2/20\n","582/582 [==============================] - 88s 152ms/step - loss: 0.1996 - acc: 0.9160 - val_loss: 0.1582 - val_acc: 0.9347\n","\n","Epoch 00002: val_loss improved from 0.16704 to 0.15817, saving model to my_checkpoint.ckpt\n","Epoch 3/20\n"," 80/582 [===>..........................] - ETA: 1:01 - loss: 0.1838 - acc: 0.9194"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"wwnduSgRiBw8"},"source":["## 학습 완료 후 Load Weights (ModelCheckpoint)"]},{"cell_type":"markdown","metadata":{"id":"kLqb_6XrMvdq"},"source":["학습이 완료된 후에는 반드시 `load_weights`를 해주어야 합니다.\n","\n","그렇지 않으면, 열심히 ModelCheckpoint를 만든 의미가 없습니다."]},{"cell_type":"code","metadata":{"id":"4jO1ucZ9ninH"},"source":["# checkpoint 를 저장한 파일명을 입력합니다.\n","model.load_weights(checkpoint_path)"],"execution_count":null,"outputs":[]}]}